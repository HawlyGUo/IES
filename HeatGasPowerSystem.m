function mpc = worui
mpc.version = '2';

%%-----  Power Flow Data  -----%%
%% system MVA base
mpc.baseMVA = 100;

%% bus data
%	bus_i	type	Pd	Qd	Gs	Bs	area	Vm	Va	baseKV	zone	Vmax	Vmin
mpc.bus = [
	1	1	97.6	44.2	0	0	2	1.0393836	-13.536602	345	1	1.06	0.94;
	2	1	0	0	0	0	2	1.0484941	-9.7852666	345	1	1.06	0.94;
	3	1	322	2.4	0	0	2	1.0307077	-12.276384	345	1	1.06	0.94;
	4	1	500	184	0	0	1	1.00446	-12.626734	345	1	1.06	0.94;
	5	1	0	0	0	0	1	1.0060063	-11.192339	345	1	1.06	0.94;
	6	1	0	0	0	0	1	1.0082256	-10.40833	345	1	1.06	0.94;
	7	1	233.8	84	0	0	1	0.99839728	-12.755626	345	1	1.06	0.94;
	8	1	522	176.6	0	0	1	0.99787232	-13.335844	345	1	1.06	0.94;
	9	1	6.5	-66.6	0	0	1	1.038332	-14.178442	345	1	1.06	0.94;
	10	1	0	0	0	0	1	1.0178431	-8.170875	345	1	1.06	0.94;
	11	1	0	0	0	0	1	1.0133858	-8.9369663	345	1	1.06	0.94;
	12	1	8.53	88	0	0	1	1.000815	-8.9988236	345	1	1.06	0.94;
	13	1	0	0	0	0	1	1.014923	-8.9299272	345	1	1.06	0.94;
	14	1	0	0	0	0	1	1.012319	-10.715295	345	1	1.06	0.94;
	15	1	320	153	0	0	3	1.0161854	-11.345399	345	1	1.06	0.94;
	16	1	329	32.3	0	0	3	1.0325203	-10.033348	345	1	1.06	0.94;
	17	1	0	0	0	0	2	1.0342365	-11.116436	345	1	1.06	0.94;
	18	1	158	30	0	0	2	1.0315726	-11.986168	345	1	1.06	0.94;
	19	1	0	0	0	0	3	1.0501068	-5.4100729	345	1	1.06	0.94;
	20	1	680	103	0	0	3	0.99101054	-6.8211783	345	1	1.06	0.94;
	21	1	274	115	0	0	3	1.0323192	-7.6287461	345	1	1.06	0.94;
	22	1	0	0	0	0	3	1.0501427	-3.1831199	345	1	1.06	0.94;
	23	1	247.5	84.6	0	0	3	1.0451451	-3.3812763	345	1	1.06	0.94;
	24	1	308.6	-92.2	0	0	3	1.038001	-9.9137585	345	1	1.06	0.94;
	25	1	224	47.2	0	0	2	1.0576827	-8.3692354	345	1	1.06	0.94;
	26	1	139	17	0	0	2	1.0525613	-9.4387696	345	1	1.06	0.94;
	27	1	281	75.5	0	0	2	1.0383449	-11.362152	345	1	1.06	0.94;
	28	1	206	27.6	0	0	3	1.0503737	-5.9283592	345	1	1.06	0.94;
	29	1	283.5	26.9	0	0	3	1.0501149	-3.1698741	345	1	1.06	0.94;
	30	2	0	0	0	0	2	1.0499	-7.3704746	345	1	1.06	0.94;
	31	3	9.2	4.6	0	0	1	0.982	0	345	1	1.06	0.94;
	32	2	0	0	0	0	1	0.9841	-0.1884374	345	1	1.06	0.94;
	33	2	0	0	0	0	3	0.9972	-0.19317445	345	1	1.06	0.94;
	34	2	0	0	0	0	3	1.0123	-1.631119	345	1	1.06	0.94;
	35	2	0	0	0	0	3	1.0494	1.7765069	345	1	1.06	0.94;
	36	2	0	0	0	0	3	1.0636	4.4684374	345	1	1.06	0.94;
	37	2	0	0	0	0	2	1.0275	-1.5828988	345	1	1.06	0.94;
	38	2	0	0	0	0	3	1.0265	3.8928177	345	1	1.06	0.94;
	39	2	1104	250	0	0	1	1.03	-14.535256	345	1	1.06	0.94;
];

%% generator data
%	bus	Pg	Qg	Qmax	Qmin	Vg    mBase	status	Pmax	Pmin minup mindown  initup initdown	rampup	rampdown	type
mpc.gen = [
	30	78	0	300     -300	0.998	100     1	1040    100      5       3       20       0       500	500         2;
    31	0	0	50      -13     0.99	100     1	646     50       4       2       20       0       300	300         1;
    32	38	0	300     -300	1.015	100     1	725     70       3       2       20       0       350 350         1;
    33	38	0	200     -147	1.05	100     1	652     60       3       2       20       0       300	300         2;
    34	0	0	120     -35     0.99	100     1	508     50       4       2       24       0       250	250         1;
    35	25	0	30      -10     0.97	100     1	687     60       3       2       20       0       300	300         1;
    36	0	0	50      -16     0.973	100     1	580     50       1       1       20       0       300	300         1;
    37	0	0	24      -8      0.96522	100     0	564     50       1       2       0       20       250	250         1;
    38	0	0	24      -8      0.96522	100     0	865     80       1       2       0       20       400	400         1;
    39	0	0	24      -8      0.96522	100     0	1100    110      1       2       0       20       550	550         1;
];

%%-----  OPF Data  -----%%
%% generator cost data
%	1	startup	shutdown	n	x1	y1	...	xn	yn
%	2	startup	shutdown	n	c(n-1)	...	c0
mpc.gencost = [
	2	0	0	3	0.077	19.71	1469;
	2	0	0	3	0.009	21.02	2639;
	2	0	0	3	0.009	21.02	2639;
	2	0	0	3	0.030	20.31	1469;
	2	0	0	3	0.077	24.02	2839;
	2	0	0	3	0.009	21.02	2639;
	2	0	0	3	0.009	21.02	2639;
	2	0	0	3	0.030	20.31	1469;
	2	0	0	3	0.077	19.71	1469;
	2	0	0	3	0.077	19.71	1469;
];

%%
%热力系统
mpc.HeatBranch = [
%index fbus tbus FlowWater(kg/s) length(m)  diameter(m)roughness conductivity
    1   1   2   265.85          3500        0.8         0.0005	0.12;
    2   2   3   241.41          1750        0.8         0.0005	0.12;
    3   3   4   143.58          1750        0.8         0.0005	0.12;
    4   2   5   24.44           1750        0.8         0.0005	0.12;
    5   3   6   67.61           1750        0.8         0.0005	0.12;
    6   3   9   30.22            825        0.8         0.0005	0.12;
    7   7   8   265.85          3500        0.8         0.0005	0.12;
    8   8   9   241.41          1750        0.8         0.0005	0.12;
    9   8   11  24.44           1750        0.8         0.0005	0.12;
    10  9   12  128.04          1750        0.8         0.0005	0.12;
    11  9   10  143.58          1750        0.8         0.0005	0.12;
];
mpc.HeatBranch(:,4) = mpc.HeatBranch(:,4)*3600*500;%(kg/h)
mpc.HeatBus = [
% index busType %(3=热源，2=负荷，1=不发生热交换的节点) Load    Tsmin   Tsmax   Trmin   Trmax
    1       3                                           0       80     120     60      100;  
    2       1                                           0       80     120     60     100;
    3       1                                           0       80     120     60      100;
    4       2                                           47.2     80     120     60      100;
    5       2                                           8       80     120     60      100;
    6       2                                           22      80     120     60      100;
    7       3                                           0       80     120     60      100;
    8       1                                           0      80     120     60      100;
    9       1                                           0       80     120     60      100;  
    10      2                                           47.2      80     120     60     100;
    11      2                                           8       80     120     60      100;
    12      2                                           42    80     120     60      100;
];
mpc.SituationTempreture = [
    -10 -10 -10 -10 ...
    -10 -10 -10 -10 ...
    -8.84  -8.84 -8.84 -8.84 ...
    -9.42 -9.42 -9.42 -9.42 ...
    -9.42 -9.42 -9.42 -9.42 ...
    -9.42 -9.42 -9.42 -9.42 ...
    -8.84  -8.84 -8.84 -8.84 ...
    -8.84  -8.84 -8.84 -8.84 ...
    -7.10 -7.10 -7.10 -7.10 ...
    -6.52  -6.52  -6.52  -6.52  ...
    -5.94 -5.94 -5.94 -5.94 ...
    -5.35 -5.35 -5.35 -5.35 ...
    -4.77 -4.77 -4.77 -4.77 ...
    -4.77 -4.77 -4.77 -4.77 ...
    -4.77 -4.77 -4.77 -4.77 ...
    -5.35 -5.35 -5.35 -5.35 ...
    -5.94 -5.94 -5.94 -5.94 ...
    -6.52  -6.52  -6.52  -6.52  ...
    -6.52  -6.52  -6.52  -6.52  ...
    -6.52  -6.52  -6.52  -6.52  ...
   -7.10 -7.10 -7.10 -7.10 ...
   -7.68 -7.68 -7.68 -7.68 ...
   -8.26 -8.26 -8.26 -8.26 ...
   -8.26 -8.26 -8.26 -8.26 
];
mpc.CHPgen = [
%HeatBus PowersystemBus
    1       30            24.2    0.31    2.40;
    7       33            24.2    0.31    2.40;
    ];
mpc.EBoiler = [
%bus(Heat)  bus(power system)
    1           39;
];
end
